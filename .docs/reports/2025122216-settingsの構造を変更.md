# 実装報告書: settings の構造を変更

作成日時: 2025-12-22 16:58

## 実装内容の概要

- 設定読み込みを setting.yaml と env.yaml の 2 ファイル入力に変更し、env.yaml の値で $ 変数を置換した設定を生成するようにした
- CommandSpec から cwd を削除し、runner 側の起動も program と args のみに統一した
- 設定サンプルを .docs/.config 配下へ移動した

## 実装した機能

- 設定の $ 変数置換
  - program と args の各要素が $ で始まる場合、env.yaml のキーに一致すれば値へ置換する
  - 一致しない場合は未置換のまま残す
- settings 読み出し経路の整理
  - config::load_settings が setting.yaml と env.yaml を読み込み、置換後 Settings を返す

## 変更点

- 設定サンプル配置
  - .config/env.yaml を削除し、.docs/.config/env.yaml を追加
  - .config/setting.yaml を .docs/.config/setting.yaml へ移動
- 設定スキーマ
  - CommandSpec から cwd を削除
- API 変更
  - config::load_settings の引数を (setting_path, env_path) に変更
  - runner::spawn_command の引数から env_vars を削除
- CLI 変更
  - paths コマンドを廃止し、settings コマンドを追加
- UI
  - src/ui.rs は引数で settings と env_vars を受け取る形へ変更
  - src/main.rs からの UI 起動はコメントアウトされている

## 影響範囲と互換性

- これまで env.yaml を子プロセスへ渡す環境変数として使っていた場合、現状の runner は env を設定しないため挙動が変わる
- 設定内の cwd 指定は利用できない

## 動作確認

- このコミット単体での動作確認は未実施
