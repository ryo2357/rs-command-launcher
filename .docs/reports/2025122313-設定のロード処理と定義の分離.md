# 実装報告書: 設定のロード処理と定義の分離

作成日時: 2025-12-23 13:58

## 実装内容の概要

- 設定の探索パス解決と読み込み処理を整理し、読み込み用の定義と実際に扱うモデルを分離した
- コマンド一覧をモデル（Commands）として扱い、検索や重複排除などの責務を集約した
- env.yaml のスキーマを env 配下にまとめる形式へ変更した

## 実装した機能

- 設定ロード処理の整理
  - 設定パス解決を config 側へ集約し、呼び出し側がパスを渡さずに読み込めるようにした
  - 設定ファイルの読み込み用に LoadSettings / LoadEnv を導入し、読み込み後にモデルへ変換する構造にした
- コマンドモデルの追加
  - Commands に first / find_by_name / extend を実装した
  - name 重複の排除（最初の出現を残す、マージ時は最後の出現を残す）を追加した
  - 設定内の $ 変数を env.yaml の値で置換する処理を Commands 側に集約した

## 変更点

- 設定サンプル
  - .docs/.config/env.yaml のトップレベルを env に変更した
- モジュール構成
  - src/paths.rs を削除した
  - src/model/commands.rs と src/model/mod.rs を追加した
- API 変更
  - config::load_settings は引数を受け取らず Commands を返す
  - runner は CommandSpec のフィールド直接参照から getter 経由に変更した
- CLI 変更
  - `settings` を `list` に変更した

## 影響範囲と互換性

- env.yaml の形式が変わったため、従来のファイルは読み込めない
- 設定パス解決の責務が移動したため、パスを直接指定したい場合は追加対応が必要になる

## 動作確認

- 実装報告書作成時点では未実施
