# 実装報告書: hotkey による表示・非表示の変更機能の実装

- 対象コミット
  - 9f5e3595e11c90c91597f29b7ec08fa4503881bb
  - hotkey による表示・非表示の変更機能の実装

## 目的

- 常駐利用を想定し、グローバルホットキーでランチャー UI の表示/非表示を切り替えられるようにする

## 実装内容

- 依存関係の追加

  - windows-sys を追加し Win32 API を利用する
  - raw-window-handle を追加し eframe のウィンドウハンドルから HWND を取得する

- ホットキー処理の追加

  - src/ui/hotkey.rs を新規追加
  - Alt+Space を RegisterHotKey で登録し、WM_HOTKEY を受けて ShowWindow で表示/非表示を切り替える
  - Drop で WM_QUIT を送信し、スレッド終了と UnregisterHotKey を行う

- UI 起動経路の整理

  - src/ui/runnner.rs を新規追加し eframe::run_native を集約
  - src/main.rs の引数なし起動時の UI 起動先を ui::runnner::run に変更

- Launcher 側の初期化処理更新
  - src/ui/launcher.rs で Frame から HWND を取得する
  - 初回 update でホットキー登録を行う

## 仕様書への反映

- .docs/specs/project.md

  - グローバルホットキー（表示/非表示切り替え）を実装済みに更新
  - UI 構成（hotkey と runnner）を追記

- .docs/specs/history.md
  - 上記の仕様変更履歴を追記

## 影響範囲と注意点

- Alt+Space は Windows のシステムメニューと競合しやすく、RegisterHotKey が失敗する場合がある
- ホットキー登録に失敗した場合でも UI 起動は継続し、ログにエラーを出力する
- Windows 専用 API を利用しているため、他 OS の動作は考慮していない

## 動作確認

- ビルド
  - cargo build
- 実行
  - cargo run
- 動作
  - UI 表示中に Alt+Space で表示/非表示を切り替える
